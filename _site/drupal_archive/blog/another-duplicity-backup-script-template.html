<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Duplicity backup script template | Dave Parrish</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link type="text/css" rel="stylesheet" media="all" href="../sites/webpagedeveloper.me/files/css/css_100687e636434ff5883b7a0da26e427f.css" />
  <script type="text/javascript" src="../sites/webpagedeveloper.me/files/js/js_44b28fe23efd28d71ff2a59da30fa2ca.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, { "basePath": "/", "googleanalytics": { "trackOutgoing": 1, "trackMailto": 1, "trackDownload": 1, "trackDownloadExtensions": "7z|aac|arc|arj|asf|asx|avi|bin|csv|doc|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls|xml|z|zip" }, "lightbox2": { "rtl": 0, "file_path": "/(\\w\\w/)sites/webpagedeveloper.me/files", "default_image": "/sites/all/modules/lightbox2/images/brokenimage.jpg", "border_size": 10, "font_color": "000", "box_color": "fff", "top_position": "", "overlay_opacity": "0.8", "overlay_color": "000", "disable_close_click": 1, "resize_sequence": 0, "resize_speed": 400, "fade_in_speed": 400, "slide_down_speed": 600, "use_alt_layout": 0, "disable_resize": 0, "disable_zoom": 0, "force_show_nav": 0, "show_caption": true, "loop_items": 0, "node_link_text": "", "node_link_target": 0, "image_count": "Image !current of !total", "video_count": "Video !current of !total", "page_count": "Page !current of !total", "lite_press_x_close": "press \x3ca href=\"#\" onclick=\"hideLightbox(); return FALSE;\"\x3e\x3ckbd\x3ex\x3c/kbd\x3e\x3c/a\x3e to close", "download_link_text": "", "enable_login": false, "enable_contact": false, "keys_close": "c x 27", "keys_previous": "p 37", "keys_next": "n 39", "keys_zoom": "z", "keys_play_pause": "32", "display_image_size": "original", "image_node_sizes": "()", "trigger_lightbox_classes": "", "trigger_lightbox_group_classes": "", "trigger_slideshow_classes": "", "trigger_lightframe_classes": "", "trigger_lightframe_group_classes": "", "custom_class_handler": 0, "custom_trigger_classes": "", "disable_for_gallery_lists": true, "disable_for_acidfree_gallery_lists": true, "enable_acidfree_videos": true, "slideshow_interval": 5000, "slideshow_automatic_start": true, "slideshow_automatic_exit": true, "show_play_pause": true, "pause_on_next_click": false, "pause_on_previous_click": true, "loop_slides": false, "iframe_width": 600, "iframe_height": 400, "iframe_border": 1, "enable_video": 0 } });
//--><!]]>
</script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
window.google_analytics_uacct = "UA-9522659-1";
//--><!]]>
</script>
  <!--[if lt IE 7]>
    <link type="text/css" rel="stylesheet" media="all" href="/sites/all/themes/interactive_media_modified/fix-ie.css" />  <![endif]-->
  <script type="text/javascript"> </script>
</head>

<body class="not-front not-logged-in page-node node-type-blog no-sidebars">
<div id="wrapper"><!-- begin wrapper -->
<div id="container" class="clear-block"><!-- begin container -->
  <div id="header"><!-- begin header -->
        <div id="slogan-floater"><!-- begin slogan-floater -->
      <h1 class='site-name'><a href="../index.html" title="Dave Parrish">Dave Parrish</a></h1>      <div class='site-slogan'>Freelance web page developer</div>    </div><!-- end slogan-floater -->
    <!-- begin primary_links -->
      <ul class="primary-links"><li class="menu-153 first"><a href="../service.html" title="Hire me">Service</a></li>
<li class="menu-246"><a href="../portfolio.html">Portfolio</a></li>
<li class="menu-159"><a href="../contact.html" title="Contact me with your feedback or questions.">Contact</a></li>
<li class="menu-715 last"><a href="../user/login0851.html?destination=node%2F50" title="Log in, create new account or request new password." class="popups-form-reload">Log in/Create account</a></li>
</ul>    <!-- end primary_links -->
  </div><!-- end header -->
  <div id="breadcrumb"><div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../blog.html">Blogs</a> » <a href="../blogs/david.html">David&#039;s blog</a></div></div>
      <div id="center"><div id="squeeze"><!-- begin center -->
    <h2 class="title">Another duplicity backup script template</h2>                <div class="clear-block">
      <div class="node">
    <div class="meta meta-header">
            <div class="submitted">Submitted by <a href="../users/david.html" title="View user profile.">David</a> on Fri, 2012-09-14 22:09</div>    <div class="terms"><ul class="links inline"><li class="taxonomy_term_61 first"><a href="../category/tags/backup.html" rel="tag" title="">backup</a></li>
<li class="taxonomy_term_52"><a href="../category/tags/bash.html" rel="tag" title="">bash</a></li>
<li class="taxonomy_term_35"><a href="../category/tags/duplicity.html" rel="tag" title="">duplicity</a></li>
<li class="taxonomy_term_62"><a href="../category/tags/gist.html" rel="tag" title="">gist</a></li>
<li class="taxonomy_term_63 last"><a href="../category/tags/git-hub.html" rel="tag" title="">git hub</a></li>
</ul></div>  </div>
  <div class="content">
    <!-- google_ad_section_start --><p>After much deliberation, I've decided on a backup strategy. &nbsp;I will backup any given computer on a computer in my local network, or a USB hard drive. &nbsp;In addition to that I will give a hard drive to one of my friends for safe keeping and backup to that hard drive from time to time, when I visit him. &nbsp;It isn't an ideal backup solution for several reasons. &nbsp;For example, I might forget to backup because it isn't automated and I have to travel to make an offsite backup but it does protect me in the event that my house was to burn down and I don't have to pay monthly costs to a backup service. &nbsp;I'm still testing it out, so we will see how it goes and how much I like the backup strategy.</p><p>Here is a template I created for backing up my personal computers using duplicity. &nbsp;All I need to do is change a few parameters at the top of the script to backup to a different device or even a dedicated backup server on the internet.</p><p>Enjoy!</p>
<pre style="color: rgb(0, 0, 0); line-height: normal; text-align: -webkit-auto; word-wrap: break-word; white-space: pre-wrap; ">#!/bin/bash

# Backup all important files on my computer using Duplicity

# Folders to include
include_directories=(/home/me /etc)

# Folders to exclude
exclude_directories=()

# duplicity path to backup to.
destination=<span data-scayt_word="ssh" data-scaytid="17">ssh</span>://<span data-scayt_word="otherComputer" data-scaytid="18">otherComputer</span>/backup/<span data-scayt_word="myComputer" data-scaytid="19">myComputer</span>

# Set <span data-scayt_word="passphrase" data-scaytid="20">passphrase</span>
export <span data-scayt_word="PASSPHRASE" data-scaytid="23">PASSPHRASE</span>="Secure <span data-scayt_word="passphrase" data-scaytid="21">passphrase</span> here.  Don't forget to back me up!"

# Log directory
LOG_DIRECTORY=/home/me/log

# ======= NOTICE ================================
# You probably don't need to edit below this line.
# You have been warned!
# ================================================

# If duplicity is already running then exit
if [ $(<span data-scayt_word="ps" data-scaytid="25">ps</span> aux | <span data-scayt_word="grep" data-scaytid="26">grep</span> 'duplicity' | <span data-scayt_word="grep" data-scaytid="27">grep</span> -v '<span data-scayt_word="grep" data-scaytid="28">grep</span>\|duplicity_backup.sh' | <span data-scayt_word="wc" data-scaytid="29">wc</span> -l | <span data-scayt_word="tr" data-scaytid="30">tr</span> -s "\n") -ne 0 ]; then 
  echo "Duplicity is already running, exiting."
  #exit
<span data-scayt_word="fi" data-scaytid="31">fi</span>

include_parameters=""
for include_directory in ${include_directories[*]}
do
  include_parameters="$include_parameters --include $include_directory"
done

exclude_parameters=""
for exclude_directory in ${exclude_directories[*]}
do
  exclude_parameters="$exclude_parameters --exclude $exclude_directory"
done

TIMESTAMP=`date +%m%d%Y%H%M`

# Run duplicity command
BACKUP_LOG_FILE="$LOG_DIRECTORY/duplicity_backup_$TIMESTAMP.log"

duplicity \
  $include_parameters $exclude_parameters \
  --exclude '**' \
  --full-if-older-than <span data-scayt_word="1Y" data-scaytid="32">1Y</span> \
  / "$destination" &gt; $BACKUP_LOG_FILE

# Only keep around 1 full backup.
echo -e '\n\n==== REMOVE OLD BACKUP SETS ====\n\n' &gt;&gt; $BACKUP_LOG_FILE
duplicity remove-all-but-n-full 1 \
  "$destination" &gt;&gt; $BACKUP_LOG_FILE

cat $BACKUP_LOG_FILE

# Clear <span data-scayt_word="passphrase" data-scaytid="22">passphrase</span>
export <span data-scayt_word="PASSPHRASE" data-scaytid="24">PASSPHRASE</span>=</pre>
<script src="https://gist.github.com/3726009.js?file=duplicity_backup.sh"></script><!-- google_ad_section_end -->    <div class="meta meta-footer">
      <ul class="links inline"><li class="blog_usernames_blog first last"><a href="../blogs/david.html" title="Read David&#039;s latest blog entries.">David&#039;s blog</a></li>
</ul>    </div>
  </div>
</div>
    </div>
      </div></div><!-- end center -->
    <div id="footer"><!-- start footer -->
          </div><!-- end footer -->
</div><!-- end wrapper -->
</div><!-- end container -->
<script type="text/javascript">
<!--//--><![CDATA[//><!--
var _gaq = _gaq || [];_gaq.push(["_setAccount", "UA-9522659-1"]);_gaq.push(["_setVar", "anonymous user"]);_gaq.push(['_setCustomVar', 1, "User roles", "anonymous user", 1]);_gaq.push(["_trackPageview"]);(function() {var ga = document.createElement("script");ga.type = "text/javascript";ga.async = true;ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";var s = document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ga, s);})();
//--><!]]>
</script>
</body>

<!-- Mirrored from webpagedeveloper.me/blog/another-duplicity-backup-script-template by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 12 Jun 2013 15:46:06 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
</html>
