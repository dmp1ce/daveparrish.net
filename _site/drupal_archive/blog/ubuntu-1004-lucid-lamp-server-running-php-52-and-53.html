<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Ubuntu PHP 5.2 and 5.3 | Dave Parrish</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link type="text/css" rel="stylesheet" media="all" href="../sites/webpagedeveloper.me/files/css/css_100687e636434ff5883b7a0da26e427f.css" />
  <script type="text/javascript" src="../sites/webpagedeveloper.me/files/js/js_44b28fe23efd28d71ff2a59da30fa2ca.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, { "basePath": "/", "googleanalytics": { "trackOutgoing": 1, "trackMailto": 1, "trackDownload": 1, "trackDownloadExtensions": "7z|aac|arc|arj|asf|asx|avi|bin|csv|doc|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls|xml|z|zip" }, "lightbox2": { "rtl": 0, "file_path": "/(\\w\\w/)sites/webpagedeveloper.me/files", "default_image": "/sites/all/modules/lightbox2/images/brokenimage.jpg", "border_size": 10, "font_color": "000", "box_color": "fff", "top_position": "", "overlay_opacity": "0.8", "overlay_color": "000", "disable_close_click": 1, "resize_sequence": 0, "resize_speed": 400, "fade_in_speed": 400, "slide_down_speed": 600, "use_alt_layout": 0, "disable_resize": 0, "disable_zoom": 0, "force_show_nav": 0, "show_caption": true, "loop_items": 0, "node_link_text": "", "node_link_target": 0, "image_count": "Image !current of !total", "video_count": "Video !current of !total", "page_count": "Page !current of !total", "lite_press_x_close": "press \x3ca href=\"#\" onclick=\"hideLightbox(); return FALSE;\"\x3e\x3ckbd\x3ex\x3c/kbd\x3e\x3c/a\x3e to close", "download_link_text": "", "enable_login": false, "enable_contact": false, "keys_close": "c x 27", "keys_previous": "p 37", "keys_next": "n 39", "keys_zoom": "z", "keys_play_pause": "32", "display_image_size": "original", "image_node_sizes": "()", "trigger_lightbox_classes": "", "trigger_lightbox_group_classes": "", "trigger_slideshow_classes": "", "trigger_lightframe_classes": "", "trigger_lightframe_group_classes": "", "custom_class_handler": 0, "custom_trigger_classes": "", "disable_for_gallery_lists": true, "disable_for_acidfree_gallery_lists": true, "enable_acidfree_videos": true, "slideshow_interval": 5000, "slideshow_automatic_start": true, "slideshow_automatic_exit": true, "show_play_pause": true, "pause_on_next_click": false, "pause_on_previous_click": true, "loop_slides": false, "iframe_width": 600, "iframe_height": 400, "iframe_border": 1, "enable_video": 0 } });
//--><!]]>
</script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
window.google_analytics_uacct = "UA-9522659-1";
//--><!]]>
</script>
  <!--[if lt IE 7]>
    <link type="text/css" rel="stylesheet" media="all" href="/sites/all/themes/interactive_media_modified/fix-ie.css" />  <![endif]-->
  <script type="text/javascript"> </script>
</head>

<body class="not-front not-logged-in page-node node-type-blog no-sidebars">
<div id="wrapper"><!-- begin wrapper -->
<div id="container" class="clear-block"><!-- begin container -->
  <div id="header"><!-- begin header -->
        <div id="slogan-floater"><!-- begin slogan-floater -->
      <h1 class='site-name'><a href="../index.html" title="Dave Parrish">Dave Parrish</a></h1>      <div class='site-slogan'>Freelance web page developer</div>    </div><!-- end slogan-floater -->
    <!-- begin primary_links -->
      <ul class="primary-links"><li class="menu-153 first"><a href="../service.html" title="Hire me">Service</a></li>
<li class="menu-246"><a href="../portfolio.html">Portfolio</a></li>
<li class="menu-159"><a href="../contact.html" title="Contact me with your feedback or questions.">Contact</a></li>
<li class="menu-715 last"><a href="../user/login67fa.html?destination=node%2F38" title="Log in, create new account or request new password." class="popups-form-reload">Log in/Create account</a></li>
</ul>    <!-- end primary_links -->
  </div><!-- end header -->
  <div id="breadcrumb"><div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../blog.html">Blogs</a> » <a href="../blogs/david.html">David&#039;s blog</a></div></div>
      <div id="center"><div id="squeeze"><!-- begin center -->
    <h2 class="title">Ubuntu 10.04 Lucid LAMP server running php 5.2 and 5.3</h2>                <div class="clear-block">
      <div class="node">
    <div class="meta meta-header">
            <div class="submitted">Submitted by <a href="../users/david.html" title="View user profile.">David</a> on Tue, 2010-07-13 12:14</div>    <div class="terms"><ul class="links inline"><li class="taxonomy_term_30 first"><a href="../category/tags/apache.html" rel="tag" title="">apache</a></li>
<li class="taxonomy_term_4"><a href="../category/tags/drupal.html" rel="tag" title="">drupal</a></li>
<li class="taxonomy_term_32"><a href="../category/tags/lucid.html" rel="tag" title="">lucid</a></li>
<li class="taxonomy_term_29"><a href="../category/tags/php.html" rel="tag" title="">php</a></li>
<li class="taxonomy_term_15"><a href="../category/tags/ubuntu.html" rel="tag" title="">ubuntu</a></li>
<li class="taxonomy_term_31 last"><a href="../category/tags/ubuntu-1004.html" rel="tag" title="">ubuntu 10.04</a></li>
</ul></div>  </div>
  <div class="content">
    <!-- google_ad_section_start --><p><span style="font-size: 8px;">Note: I could not get 5.2 and 5.3 running at the same time. I could only get them both installed so where I could quickly enable one or the other.&nbsp; I had to use <code>a2enmod php5</code> and <code>a2dismod php5</code> to turn PHP 5.2 on and off because PHP 5.3 would also take priority otherwise.</span></p><p>Lately I have been doing more and more Drupal development on a remote development server.&nbsp; Working on the server make it easier to show the client my work and I rarely have to set anything up locally, which saves me time.&nbsp; However, for a recent project I needed to debug the uc_signup module because of some errors I was getting and I didn't want to put <code>print</code> and <code>die()</code> commands on the dev server where others were working too.&nbsp; I started to setup the Drupal project on my local Ubuntu computer just recently updated with 10.04 Lucid and to my surprise I was getting errors I had never seen before.&nbsp; After a little investigation I realized that the errors were occuring because the code in <a href="http://drupal.org/node/835880">uc_signup</a> and <a href="http://drupal.org/node/613528">calendar</a> were not completely compatible with PHP 5.3 which is now the PHP default for Ubuntu 10.04.&nbsp; I'm sure there are <a href="http://drupal.org/project/issues?text=php+5.3&amp;projects=&amp;status=Open&amp;priorities=All&amp;categories=All">issues with other modules having to do with PHP 5.3</a> as well.</p><p>So, given the situation I decided to setup my environment to run 5.2.&nbsp; However, I didn't want to remove 5.3 because I like being able to see if Drupal modules will run on PHP 5.3 as I'm sure I'll be using 5.3 in the future.&nbsp; What I wanted was to run PHP 5.2 along side PHP 5.3 with as little trouble as possible.&nbsp; In short, what I ended up doing was compiling PHP 5.2.13 and running it using FastCGI.&nbsp; Here is the summary of steps:</p><p><span style="font-size: 8px;">(Much of these steps were taken from <a href="http://cuadradevelopment.com/blog/26/multiple-php-versions-with-apache-using-fastcgi-on-os-x/">this excelent post on how to run PHP 5.2 and PHP 5.3 side-by-side on Mac OS X</a>)</span></p><p>Download PHP 5.2.xx.&nbsp; <a href="http://php.net/downloads.php" title="http://php.net/downloads.php">http://php.net/downloads.php</a></p><p>Extract PHP 5.2.xx into /opt/src.&nbsp; My directory looked like this: /opt/src/php-5.2.13</p><p>Compile PHP 5.2.xx with the correct flags.</p><p style="margin-left: 40px;">Make sure you have all the required source libraries.&nbsp; I had to install the following using Synamptic Package Manager.&nbsp; apt-get will of course work too.</p><p style="margin-left: 80px;">libxml2-dev</p><p style="margin-left: 80px;">libmysqlclient-dev</p><p style="margin-left: 80px;">libcurl4-gnutls-dev (or libcurl4-openssl-dev)</p><p style="margin-left: 80px;">libpng12-dev</p><p style="margin-left: 80px;">libjpeg62-dev</p><p style="margin-left: 40px;">Configure PHP for compiling</p><p style="margin-left: 80px;"><code>cd /opt/src/php-5.2.13</code></p><p style="margin-left: 80px;"><code>sudo ./configure --prefix=/opt/php5.2 \<br />
--with-config-file-path=/opt/php5.2 \<br />
--with-mysqli \<br />
--with-mysql \<br />
--with-curl \<br />
--with-gd \<br />
--with-jpeg \<br />
--with-jpeg-dir \<br />
--enable-cli \<br />
--enable-fastcgi \<br />
--enable-discard-path \<br />
--enable-force-cgi-redirect</code></p><p style="margin-left: 40px;">Compile - <code><kbd>sudo make</kbd></code></p><p style="margin-left: 40px;">Install - <code>sudo make install</code></p><p>Now that PHP is built I had to setup Apache to use PHP using the FastCGI module.&nbsp; I installed the FastCGI module using Synaptic Package Manager.&nbsp; The module name is libapache2-mod-fastcgi.&nbsp; Then, I think, I enabled the FastCGI module using the command <code>sudo a2enmod fastcgi</code>.&nbsp; It may be enabled by default after install.</p><p>This next section is where I struggled because my understanding of Apache configuration files is lacking.&nbsp; But I believe only two changes to the configuration files are required.&nbsp; First, I modified the <code>/etc/apache2/sites-available/default</code> file although I'm sure this code could go in a better location.&nbsp; I then added the following lines to the top of the file:</p><p style="margin-left: 40px;"><code>AddHandler fastcgi-script .fcgi<br />
FastCgiConfig -autoUpdate -singleThreshold 100 -killInterval 300<br />
ScriptAlias /fastcgi/ /var/www/cgi-bin/</code></p><p>The directory <code>/var/www/cgi-bin/</code> is where I put my wrapper cgi script for running PHP 5.2.&nbsp; The wrapper script file I named<code> php52.fcgi</code> and it contained the following text:</p><p style="margin-left: 40px;"><code>#!/bin/sh<br />
PHP_FCGI_CHILDREN=1<br />
export PHP_FCGI_CHILDREN<br />
PHP_FCGI_MAX_REQUESTS=5000<br />
export PHP_FCGI_MAX_REQUESTS<br />
exec /opt/php5.2/bin/php-cgi</code></p><p>I also set the script to be executable like so:<code> sudo chmod +x /var/www/cgi-bin/php52.fcgi</code></p><p>Finally the last bit of configuration was to edit the site vhost configuration file that I wanted to run in PHP 5.2.&nbsp; I added the line <code>Action&nbsp; application/x-httpd-php /fastcgi/php52.fcgi</code> to the sites vhost file to make it look like this:</p><p style="margin-left: 40px;"><code>&lt;VirtualHost *:80&gt;<br />
&nbsp; DocumentRoot "/my/www/dir/project/httpdocs"<br />
&nbsp; ServerName project<br />
&nbsp; Action&nbsp; application/x-httpd-php /fastcgi/php52.fcgi<br />
&lt;/VirtualHost&gt;</code></p><p>The major cavet here is that I could not figure out a way for PHP 5.2 and PHP 5.3 to run at the same time.&nbsp; This is because PHP 5.3 would alway run instead of PHP 5.2 even if I put the <code>Action&nbsp; application/x-httpd-php /fastcgi/php52.fcgi </code>line in the vhost file.&nbsp; In my situation this is OK because I'm only running the server for testing but I can see why it might be important to have both PHP versions running at the same time.&nbsp; In my situation I ran the command <code>sudo a2dismod php5</code> to disable PHP 5.3 and then restart Apache using <code>sudo /etc/init.d/apache2 restart</code>.&nbsp; If I want to run PHP 5.3 again I simply run <code>sudo a2enmod php5</code> and restart Apache again.</p><p>And that is all there is to it!&nbsp; If you see any improvements or problems please leave a comment.&nbsp; Thanks!</p><p>Sources:</p><ul><li><a href="http://cuadradevelopment.com/blog/26/multiple-php-versions-with-apache-using-fastcgi-on-os-x/" title="http://cuadradevelopment.com/blog/26/multiple-php-versions-with-apache-using-fastcgi-on-os-x/">http://cuadradevelopment.com/blog/26/multiple-php-versions-with-apache-u...</a></li><li><a href="http://packages.ubuntu.com/" title="http://packages.ubuntu.com/">http://packages.ubuntu.com/</a></li></ul><!-- google_ad_section_end -->    <div class="meta meta-footer">
      <ul class="links inline"><li class="blog_usernames_blog first last"><a href="../blogs/david.html" title="Read David&#039;s latest blog entries.">David&#039;s blog</a></li>
</ul>    </div>
  </div>
</div>
<div id="comments">
  <a id="comment-95"></a>
<div class="comment comment-published clear-block">
  <h3 class="title"><a href="ubuntu-1004-lucid-lamp-server-running-php-52-and-53.html#comment-95" class="active">enable xdebug</a></h3>
  <div class="meta meta-header">
        <div class="submitted">Submitted by Anonymous on Mon, 2010-07-26 09:54.</div>  </div>
  <div class="content">
    <p>Hi, great article</p>
<p>I can't enable xdebug with this metod</p>
<p>I edit /opt/php5.2/php.ini with<br />
zend_extension=/usr/lib/php5/20090626+lfs/xdebug.so<br />
xdebug.remote_enable=On<br />
xdebug.remote_host="localhost"<br />
xdebug.remote_port=9000<br />
xdebug.remote_handler="dbgp"</p>
<p>but /opt/php5.2/bin/php-cgi -m<br />
tells me there is no xdebug module</p>
<p>xdebug works with php 5.3.2</p>
<p>Thanks</p>
        <div class="meta meta-footer">
          </div>
  </div>
</div>
<div class="indented"><a id="comment-96"></a>
<div class="comment comment-published clear-block">
  <h3 class="title"><a href="ubuntu-1004-lucid-lamp-server-running-php-52-and-53.html#comment-96" class="active">xdebug for php 5.2.13</a></h3>
  <div class="meta meta-header">
        <div class="submitted">Submitted by Anonymous on Mon, 2010-07-26 12:03.</div>  </div>
  <div class="content">
    <p>I solved from <a href="http://packages.ubuntu.com/karmic/i386/php5-xdebug/download" title="http://packages.ubuntu.com/karmic/i386/php5-xdebug/download">http://packages.ubuntu.com/karmic/i386/php5-xdebug/download</a></p>
<p>copy /usr/lib/php5/20060613+lfs/xdebug.so</p>
<p>and then fix /opt/php5.2/php.ini with<br />
zend_extension=/usr/lib/php5/20060613+lfs/xdebug.so<br />
xdebug.remote_enable=On<br />
xdebug.remote_host="localhost"<br />
xdebug.remote_port=9000<br />
xdebug.remote_handler="dbgp"</p>
        <div class="meta meta-footer">
          </div>
  </div>
</div>
</div><a id="comment-98"></a>
<div class="comment comment-published clear-block">
  <h3 class="title"><a href="ubuntu-1004-lucid-lamp-server-running-php-52-and-53.html#comment-98" class="active">Running both simultaneously</a></h3>
  <div class="meta meta-header">
        <div class="submitted">Submitted by Anonymous on Thu, 2010-10-14 22:19.</div>  </div>
  <div class="content">
    <p>Adding<br />
<code>&lt;FilesMatch "\.php"&gt;<br />
     SetHandler application/x-httpd-php<br />
&lt;/FilesMatch&gt;</code><br />
to the virtual host should force apache to use the cgi version. </p>
<p>If it still doesn't work, mine is setup using "application/x-httpd-php52" which maybe makes it work since the mime type doesn't match that of the loaded php module.</p>
        <div class="meta meta-footer">
          </div>
  </div>
</div>
<a id="comment-101"></a>
<div class="comment comment-published clear-block">
  <h3 class="title"><a href="ubuntu-1004-lucid-lamp-server-running-php-52-and-53.html#comment-101" class="active">One more module to enable</a></h3>
  <div class="meta meta-header">
        <div class="submitted">Submitted by Anonymous on Sat, 2010-11-06 12:22.</div>  </div>
  <div class="content">
    <p>Thanks for the great post! I'm doing some Drupal development on a new laptop and didn't want to drop php5.3; your post allows to me to swap back and forth between 5.3 and 5.2.</p>
<p>One problem I ran into while following your instructions was the error: "Invalid command 'Action'" when I enabled the new php5.2 site. Apparently, I needed to enable the actions module (sudo a2enmod actions) before the fast-cgi would work.</p>
<p>BTW, I found that putting the AddHandler lines in the main apache2.conf file (/etc/apache2/apache2.conf) worked fine.</p>
<p>Thanks again!</p>
        <div class="meta meta-footer">
          </div>
  </div>
</div>
<a id="comment-102"></a>
<div class="comment comment-published clear-block">
  <h3 class="title"><a href="ubuntu-1004-lucid-lamp-server-running-php-52-and-53.html#comment-102" class="active">Error &quot;xml2-config not found&quot; </a></h3>
  <div class="meta meta-header">
        <div class="submitted">Submitted by Anonymous on Sat, 2011-02-12 17:31.</div>  </div>
  <div class="content">
    <p>Hi<br />
Great Article tnx<br />
i get errors when i try to run the configure command :</p>
<p>checking whether to enable LIBXML support... yes<br />
checking libxml2 install dir... no<br />
checking for xml2-config path...<br />
configure: error: xml2-config not found. Please check your libxml2 installation.</p>
<p>I have tried to apt-get remove libxml2 and after that apt-get install libxml2  with no success </p>
<p>any help will be appreciated<br />
I use ubuntu 10.10 and run the drubuntu script to setup the machine</p>
<p>Avior</p>
        <div class="meta meta-footer">
          </div>
  </div>
</div>
<a id="comment-118"></a>
<div class="comment comment-published clear-block">
  <h3 class="title"><a href="ubuntu-1004-lucid-lamp-server-running-php-52-and-53.html#comment-118" class="active">configure: error: libjpeg.(a|so) not found.</a></h3>
  <div class="meta meta-header">
        <div class="submitted">Submitted by Anonymous on Thu, 2012-01-05 12:19.</div>  </div>
  <div class="content">
    <p>I got this error when running configure:<br />
configure: error: libjpeg.(a|so) not found.</p>
<p>Here's an article how to get through this error<br />
http://www.spiration.co.uk/post/1386/configure:-error:-libjpeg.%28a|so%29-not-found.</p>
<p>Hope this helps!</p>
        <div class="meta meta-footer">
          </div>
  </div>
</div>
<a id="comment-121"></a>
<div class="comment comment-published clear-block">
  <h3 class="title"><a href="ubuntu-1004-lucid-lamp-server-running-php-52-and-53.html#comment-121" class="active">i found great installation</a></h3>
  <div class="meta meta-header">
        <div class="submitted">Submitted by Anonymous on Mon, 2012-04-16 08:35.</div>  </div>
  <div class="content">
    <p>i found great installation instruction in this blog, found worked for me, i didnt found any post problem related to it<br />
<a href="http://www.discusswire.com/running-php-5-2-5-3-server/" title="http://www.discusswire.com/running-php-5-2-5-3-server/">http://www.discusswire.com/running-php-5-2-5-3-server/</a></p>
        <div class="meta meta-footer">
          </div>
  </div>
</div>
</div>
    </div>
      </div></div><!-- end center -->
    <div id="footer"><!-- start footer -->
          </div><!-- end footer -->
</div><!-- end wrapper -->
</div><!-- end container -->
<script type="text/javascript">
<!--//--><![CDATA[//><!--
var _gaq = _gaq || [];_gaq.push(["_setAccount", "UA-9522659-1"]);_gaq.push(["_setVar", "anonymous user"]);_gaq.push(['_setCustomVar', 1, "User roles", "anonymous user", 1]);_gaq.push(["_trackPageview"]);(function() {var ga = document.createElement("script");ga.type = "text/javascript";ga.async = true;ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";var s = document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ga, s);})();
//--><!]]>
</script>
</body>

<!-- Mirrored from webpagedeveloper.me/blog/ubuntu-1004-lucid-lamp-server-running-php-52-and-53 by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 12 Jun 2013 15:54:19 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
</html>
