<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Sending an email from the terminal using javascript | Dave Parrish</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link type="text/css" rel="stylesheet" media="all" href="../sites/webpagedeveloper.me/files/css/css_100687e636434ff5883b7a0da26e427f.css" />
  <script type="text/javascript" src="../sites/webpagedeveloper.me/files/js/js_44b28fe23efd28d71ff2a59da30fa2ca.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, { "basePath": "/", "googleanalytics": { "trackOutgoing": 1, "trackMailto": 1, "trackDownload": 1, "trackDownloadExtensions": "7z|aac|arc|arj|asf|asx|avi|bin|csv|doc|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls|xml|z|zip" }, "lightbox2": { "rtl": 0, "file_path": "/(\\w\\w/)sites/webpagedeveloper.me/files", "default_image": "/sites/all/modules/lightbox2/images/brokenimage.jpg", "border_size": 10, "font_color": "000", "box_color": "fff", "top_position": "", "overlay_opacity": "0.8", "overlay_color": "000", "disable_close_click": 1, "resize_sequence": 0, "resize_speed": 400, "fade_in_speed": 400, "slide_down_speed": 600, "use_alt_layout": 0, "disable_resize": 0, "disable_zoom": 0, "force_show_nav": 0, "show_caption": true, "loop_items": 0, "node_link_text": "", "node_link_target": 0, "image_count": "Image !current of !total", "video_count": "Video !current of !total", "page_count": "Page !current of !total", "lite_press_x_close": "press \x3ca href=\"#\" onclick=\"hideLightbox(); return FALSE;\"\x3e\x3ckbd\x3ex\x3c/kbd\x3e\x3c/a\x3e to close", "download_link_text": "", "enable_login": false, "enable_contact": false, "keys_close": "c x 27", "keys_previous": "p 37", "keys_next": "n 39", "keys_zoom": "z", "keys_play_pause": "32", "display_image_size": "original", "image_node_sizes": "()", "trigger_lightbox_classes": "", "trigger_lightbox_group_classes": "", "trigger_slideshow_classes": "", "trigger_lightframe_classes": "", "trigger_lightframe_group_classes": "", "custom_class_handler": 0, "custom_trigger_classes": "", "disable_for_gallery_lists": true, "disable_for_acidfree_gallery_lists": true, "enable_acidfree_videos": true, "slideshow_interval": 5000, "slideshow_automatic_start": true, "slideshow_automatic_exit": true, "show_play_pause": true, "pause_on_next_click": false, "pause_on_previous_click": true, "loop_slides": false, "iframe_width": 600, "iframe_height": 400, "iframe_border": 1, "enable_video": 0 } });
//--><!]]>
</script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
window.google_analytics_uacct = "UA-9522659-1";
//--><!]]>
</script>
  <!--[if lt IE 7]>
    <link type="text/css" rel="stylesheet" media="all" href="/sites/all/themes/interactive_media_modified/fix-ie.css" />  <![endif]-->
  <script type="text/javascript"> </script>
</head>

<body class="not-front not-logged-in page-node node-type-blog no-sidebars">
<div id="wrapper"><!-- begin wrapper -->
<div id="container" class="clear-block"><!-- begin container -->
  <div id="header"><!-- begin header -->
        <div id="slogan-floater"><!-- begin slogan-floater -->
      <h1 class='site-name'><a href="../index.html" title="Dave Parrish">Dave Parrish</a></h1>      <div class='site-slogan'>Freelance web page developer</div>    </div><!-- end slogan-floater -->
    <!-- begin primary_links -->
      <ul class="primary-links"><li class="menu-153 first"><a href="../service.html" title="Hire me">Service</a></li>
<li class="menu-246"><a href="../portfolio.html">Portfolio</a></li>
<li class="menu-159"><a href="../contact.html" title="Contact me with your feedback or questions.">Contact</a></li>
<li class="menu-715 last"><a href="../user/login9650.html?destination=node%2F45" title="Log in, create new account or request new password." class="popups-form-reload">Log in/Create account</a></li>
</ul>    <!-- end primary_links -->
  </div><!-- end header -->
  <div id="breadcrumb"><div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../blog.html">Blogs</a> » <a href="../blogs/david.html">David&#039;s blog</a></div></div>
      <div id="center"><div id="squeeze"><!-- begin center -->
    <h2 class="title">Sending an email from the terminal using javascript</h2>                <div class="clear-block">
      <div class="node">
    <div class="meta meta-header">
            <div class="submitted">Submitted by <a href="../users/david.html" title="View user profile.">David</a> on Tue, 2011-08-30 15:49</div>    <div class="terms"><ul class="links inline"><li class="taxonomy_term_41 first"><a href="../category/tags/email.html" rel="tag" title="">email</a></li>
<li class="taxonomy_term_14"><a href="../category/tags/javascript.html" rel="tag" title="">javascript</a></li>
<li class="taxonomy_term_40"><a href="../category/tags/node.html" rel="tag" title="">node</a></li>
<li class="taxonomy_term_39 last"><a href="../category/tags/nodejs.html" rel="tag" title="">nodejs</a></li>
</ul></div>  </div>
  <div class="content">
    <!-- google_ad_section_start --><p>For those interested, this is how I went about sending an email from a <span data-scayt_word="javascript" data-scaytid="24">javascript</span> script. &nbsp;I used <span data-scayt_word="NodeJS" data-scaytid="26">NodeJS</span> to process the <span data-scayt_word="javascript" data-scaytid="25">javascript</span>. &nbsp;I used the mailer module (node_mailer) to send the email through SMTP. &nbsp;I used the <span data-scayt_word="SendGrid" data-scaytid="30">SendGrid</span> SMTP service.</p><h2>STEP 1 -&nbsp;Get <span data-scayt_word="NodeJS" data-scaytid="27">NodeJS</span><br /><span class="Apple-style-span" style="font-size: 10px; font-weight: normal; ">https://<span data-scayt_word="github.com" data-scaytid="1">github.com</span>/<span data-scayt_word="joyent" data-scaytid="31">joyent</span>/node/wiki/<span data-scayt_word="Installing-Node.js-via-package-manager" data-scaytid="3">Installing-Node.js-via-package-manager</span></span></h2><p>I decided to use the apt-get package manager for installing <span data-scayt_word="NodeJS" data-scaytid="28">NodeJS</span> because it is easy.</p>
<pre><span data-scayt_word="sudo" data-scaytid="32">sudo</span> apt-get install python-software-properties
<span data-scayt_word="sudo" data-scaytid="33">sudo</span> add-apt-repository <span data-scayt_word="ppa" data-scaytid="36">ppa</span>:<span data-scayt_word="chris-lea" data-scaytid="37">chris-lea</span>/<span data-scayt_word="node.js" data-scaytid="4">node.js</span>
<span data-scayt_word="sudo" data-scaytid="34">sudo</span> apt-get update
<span data-scayt_word="sudo" data-scaytid="35">sudo</span> apt-get install <span data-scayt_word="nodejs" data-scaytid="38">nodejs</span></pre>
<h2>STEP 2 - Get <span data-scayt_word="NPM" data-scaytid="72">NPM</span> (node package manager)<br /><span class="Apple-style-span" style="font-size: 12px; font-weight: normal; "><small>http://</small><span data-scayt_word="npmjs.org" data-scaytid="5">npmjs.org</span>/</span></h2><p>I had no problems installing <span data-scayt_word="NPM" data-scaytid="40">NPM</span> with the package managed <span data-scayt_word="NodeJS" data-scaytid="29">NodeJS</span>.</p>
<pre>curl http://<span data-scayt_word="npmjs.org" data-scaytid="6">npmjs.org</span>/<span data-scayt_word="install.sh" data-scaytid="7">install.sh</span> | <span data-scayt_word="sh" data-scaytid="41">sh</span></pre>
<h2>STEP 3 - Get node mailer module<br /><span class="Apple-style-span" style="font-size: 10px; font-weight: normal; ">http://<span data-scayt_word="blog.nodejitsu.com" data-scaytid="8">blog.nodejitsu.com</span>/sending-emails-in-node</span></h2><p>Installing the mailer module (node_mailer) is easy enough using <span data-scayt_word="npm" data-scaytid="42">npm</span>&nbsp;but I had some problems with the specific version which I downloaded. &nbsp;First, to install the mailer module:</p>
<pre><span data-scayt_word="npm" data-scaytid="43">npm</span> install mailer</pre>
<p>If you happen to get the version of node_mailer which I had, version 0.6.6 you may need to change the version of <span data-scayt_word="nodemailer" data-scaytid="45">nodemailer</span>&nbsp;(not to be confused with node_mailer). The issue is described here:&nbsp;https://<span data-scayt_word="github.com" data-scaytid="2">github.com</span>/<span data-scayt_word="Marak" data-scaytid="46">Marak</span>/node_mailer/issues/41. &nbsp;This is how I did changed versions.</p>
<pre>cd node_modules/mailer
<span data-scayt_word="npm" data-scaytid="44">npm</span> install <span data-scayt_word="nodemailer@0.1.20" data-scaytid="9">nodemailer@0.1.20</span></pre>
<h2>STEP 4 - Setup <span data-scayt_word="Sendgrid" data-scaytid="75">Sendgrid</span> or another SMTP service</h2><h2>STEP 5 - Write script<br /><span class="Apple-style-span" style="font-size: 10px; font-weight: normal; ">http://<span data-scayt_word="ubuntuforums.org" data-scaytid="10">ubuntuforums.org</span>/<span data-scayt_word="showpost.php" data-scaytid="11">showpost.php</span>?p=10525545&amp;<span data-scayt_word="postcount" data-scaytid="48">postcount</span>=50</span></h2><p>Following the examples from a couple of different websites I was able to craft a script which sent an email the way I wanted. &nbsp;Here is an example of my script:</p>
<pre>#!/<span data-scayt_word="usr" data-scaytid="49">usr</span>/bin/<span data-scayt_word="env" data-scaytid="50">env</span> node

// Get the first parameter which is the log file
<span data-scayt_word="var" data-scaytid="51">var</span> <span data-scayt_word="logFile" data-scaytid="55">logFile</span> = <span data-scayt_word="process.argv" data-scaytid="12">process.argv</span>[2]

// Get the back log for the email
<span data-scayt_word="var" data-scaytid="52">var</span> <span data-scayt_word="fs" data-scaytid="57">fs</span> = require('<span data-scayt_word="fs" data-scaytid="58">fs</span>');
<span data-scayt_word="var" data-scaytid="53">var</span> <span data-scayt_word="emailLog" data-scaytid="60">emailLog</span> = <span data-scayt_word="fs.readFileSync" data-scaytid="13">fs.readFileSync</span>(<span data-scayt_word="logFile" data-scaytid="56">logFile</span>)<span data-scayt_word=".toString" data-scaytid="62">.toString</span>()
<span data-scayt_word="var" data-scaytid="54">var</span> email = require('mailer')

<span data-scayt_word="email.send" data-scaytid="14">email.send</span>({
  host : "<span data-scayt_word="smtp.sendgrid.com" data-scaytid="15">smtp.sendgrid.com</span>",                   // <span data-scayt_word="smtp" data-scaytid="63">smtp</span> server hostname
  port : "25",                                  // <span data-scayt_word="smtp" data-scaytid="64">smtp</span> server port
  domain : "<span data-scayt_word="serverDomain.com" data-scaytid="16">serverDomain.com</span>",             // domain used by client to identify itself to server
  to : "<span data-scayt_word="someone@somewhere.com" data-scaytid="17">someone@somewhere.com</span>",
  from : "<span data-scayt_word="server@serverDomain.com" data-scaytid="18">server@serverDomain.com</span>",
  subject : "Backup Log - " + new Date(),
  body: <span data-scayt_word="emailLog" data-scaytid="61">emailLog</span>,
  authentication : "login",                     // <span data-scayt_word="auth" data-scaytid="65">auth</span> login is supported; anything else is no <span data-scayt_word="auth" data-scaytid="66">auth</span>
  username : "<span data-scayt_word="yourUsername@emailService.com" data-scaytid="19">yourUsername@emailService.com</span>",           // <span data-scayt_word="Base64" data-scaytid="67">Base64</span> encoded username
  password : "<span data-scayt_word="yourPassword" data-scaytid="69">yourPassword</span>"                         // <span data-scayt_word="Base64" data-scaytid="68">Base64</span> encoded password
},

function(err, result){
  if(err){ <span data-scayt_word="console.log" data-scaytid="20">console.log</span>(err); }
});</pre>
<div>I did a little bit of parameter and file processing so I could use a different log file when the script is called, but that is of course optional.</div><div>&nbsp;</div><h2>STEP 6 - Run the script</h2><div>Make sure to set execution permissions.&nbsp;</div>
<pre><span data-scayt_word="chmod" data-scaytid="70">chmod</span> +x <span data-scayt_word="emailScript.js" data-scaytid="21">emailScript.js</span></pre>
<div>Then run.</div>
<pre>./<span data-scayt_word="emailScript.js" data-scaytid="22">emailScript.js</span> /root/log/<span data-scayt_word="logFile.log" data-scaytid="23">logFile.log</span></pre><!-- google_ad_section_end -->    <div class="meta meta-footer">
      <ul class="links inline"><li class="blog_usernames_blog first last"><a href="../blogs/david.html" title="Read David&#039;s latest blog entries.">David&#039;s blog</a></li>
</ul>    </div>
  </div>
</div>
    </div>
      </div></div><!-- end center -->
    <div id="footer"><!-- start footer -->
          </div><!-- end footer -->
</div><!-- end wrapper -->
</div><!-- end container -->
<script type="text/javascript">
<!--//--><![CDATA[//><!--
var _gaq = _gaq || [];_gaq.push(["_setAccount", "UA-9522659-1"]);_gaq.push(["_setVar", "anonymous user"]);_gaq.push(['_setCustomVar', 1, "User roles", "anonymous user", 1]);_gaq.push(["_trackPageview"]);(function() {var ga = document.createElement("script");ga.type = "text/javascript";ga.async = true;ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";var s = document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ga, s);})();
//--><!]]>
</script>
</body>

<!-- Mirrored from webpagedeveloper.me/blog/sending-email-terminal-using-javascript by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 12 Jun 2013 15:46:56 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
</html>
